/*! Recurve.js - v0.1.0 - by Sebastien Couture 2014-08-07 */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){!function(){"use strict";var b=window.Recurve||{};b.StringUtils=a("./recurve-string.js"),b.WindowUtils=a("./recurve-window.js"),b.ArrayUtils=a("./recurve-array.js"),b.DateUtils=a("./recurve-date.js"),b.ObjectUtils=a("./recurve-object.js"),b.assert=a("./recurve-assert.js"),b.Proto=a("./recurve-proto.js"),b.Log=a("./recurve-log.js"),b.LogConsoleTarget=a("./recurve-log-console.js"),b.Signal=a("./recurve-signal.js"),b.Http=a("./recurve-http.js"),b.GlobalErrorHandler=a("./recurve-global-error-handler.js"),window.Recurve=b}()},{"./recurve-array.js":2,"./recurve-assert.js":3,"./recurve-date.js":4,"./recurve-global-error-handler.js":5,"./recurve-http.js":6,"./recurve-log-console.js":7,"./recurve-log.js":8,"./recurve-object.js":9,"./recurve-proto.js":10,"./recurve-signal.js":11,"./recurve-string.js":12,"./recurve-window.js":13}],2:[function(a,b){"use strict";b.exports={removeItem:function(a,b){if(a){var c=a.indexOf(b);c>-1&&a.splice(c,1)}},removeAt:function(a,b){a&&b>=0&&a.length>b&&a.splice(b,1)},replaceItem:function(a,b){if(a){var c=a.indexOf(b);c>-1&&(a[c]=b)}},isEmpty:function(a){return!a||0===a.length},argumentsToArray:function(a,b){return b<a.length?Array.prototype.slice.call(a,b):[]}}},{}],3:[function(a,b){"use strict";var c=a("./recurve-string.js");b.exports=function(a,b){if(!a)throw Array.prototype.shift.apply(arguments),b=c.format.apply(this,arguments),new Error(b)}},{"./recurve-string.js":12}],4:[function(a,b){"use strict";b.exports={now:function(){return new Date},startYearFromRange:function(a){if(!a)return"";var b=a.split("-");return 0<b.length?b[0]:""},endYearFromRange:function(a){if(!a)return"";var b=a.split("-");return 2<b.length?b[2]:""}}},{}],5:[function(a,b){"use strict";var c=a("./recurve-proto.js"),d=a("./recurve-string.js"),e=a("./recurve-object.js"),f=a("./recurve-array.js");b.exports=c.define([function(a,b,c){void 0===b&&(b=!0),void 0===c&&(c=!0),this._enabled=b,this._preventBrowserHandle=c,this._onError=a,window.onerror=this._errorHandler.bind(this)},{protectedInvoke:function(a){try{var b=f.argumentsToArray(arguments,1);a.apply(null,b)}catch(c){var d=this.describeError(c);this.handleError(c,d)}},handleError:function(a,b){return this._onError&&this._onError(a,b),this._preventBrowserHandle},describeError:function(a){if(!a)return null;var b;return b=e.isString(a)?a:e.isError(a)?a.message+"\n"+a.stack:e.isObject(a)?JSON.stringify(a):a.toString()},_errorHandler:function(a,b,c,e,f){if(this._enabled){var g=d.format("message: {0}, file: {1}, line: {2}",a,b,c);return f&&(g+=d.format(", stack: {0}",f.stack)),this._onError&&this._onError(f,g),this._preventBrowserHandle}}}])},{"./recurve-array.js":2,"./recurve-object.js":9,"./recurve-proto.js":10,"./recurve-string.js":12}],6:[function(a){"use strict";function b(a,b){var c=!0;return p.contains(b,"application/x-www-form-urlencoded",c)?o.isObject(a)&&!o.isFile(a)&&(a=o.toFormData(a)):p.contains(b,"application/json",c)&&o.isObject(a)&&!o.isFile(a)&&(a=o.toJson(a)),a}function c(a,b){var c,d=!0;return p.contains(b,"application/xml",d)||p.contains(b,"text/xml",d)?c=a.responseXML:p.contains(b,"application/json",d)?c&&(c=o.toJson(a.responseText)):c=a.responseText,c}function d(a,b){var c;return c=p.isEqualIgnoreCase("jsonp",a.method)?new y(a,b):a.crossDomain&&p.isEqualIgnoreCase("script",a.method)?new z(a,b):new x(a,b)}function e(){return new v}function f(){var a=Q.defer();return a.promise.success=function(b){return a.promise.then(function(a){b(a.data,a.status,a.statusText,a.headers,a.options,a.canceled)}),this._deferred.promise},a.promise.error=function(b){return a.promise.then(null,function(a){b(a.data,a.status,a.statusText,a.headers,a.options,a.canceled)}),this._deferred.promise},a.promise.cancel=function(){a.request.cancel()},a}function g(a,b){var c=o.extend({},b);return c.headers={},h(a.method,c,b.headers),o.extend(c,a),c}function h(a,b,c){a=a.toLowerCase(),o.extend(b,c.all),o.extend(b,c[a])}function i(a){a.cache||(a.params.cache=q.now().getTime()),a.url=p.addParametersToUrl(a.url,a.params)}function j(a){k(a),l(a),m(a)}function k(a){if(!a.headers.Accept){var b="*/*",c=a.dataType;c&&(c=c.toLowerCase(),"text"===c?b="text/plain,*/*;q=0.01":"html"===c?b="text/html,*/*;q=0.01":"xml"===c?b="application/xml,text/xml,*/*;q=0.01":("json"===c||"script"===c)&&(b="application/json,text/javascript,*/*;q=0.01")),a.headers.Accept=b}}function l(a){a.crossDomain||a.headers["X-Requested-With"]||p.isEqualIgnoreCase("script",a.dataType)||(a.headers["X-Requested-With"]="XMLHttpRequest")}function m(a){a.data&&o.forEach(a.headers,function(b,c){p.isEqualIgnoreCase("content-type",c)&&delete a.headers[c]})}function n(a){if(a.data){var b=a.data;o.isFunction(a.serializer)?b=a.serializer(b,this._options.contentType):o.forEach(a.serializer,function(c){b=c(b,a.contentType)}),a.data=b}}var o=a("./recurve-object.js"),p=a("./recurve-string.js"),q=a("./recurve-window.js"),r=a("./recurve-window.js"),s=a("./recurve-signal.js"),t=a("./recurve-proto.js"),u=function(a){var b=g(a,u.defaults);i(b),j(b),n(b);var c=b.deferredFactory(b),d=b.requestFactory(b,c);return c.request=c,d.send(),c.promise};u=o.extend(u,{defaults:{headers:{all:{},get:{},post:{"Content-Type":"application/json; charset=UTF-8"},put:{"Content-Type":"application/json; charset=UTF-8"},head:{},"delete":{},jsonp:{},script:{}},method:"get",dataType:"json",cache:!0,serializer:[b],parser:[c],requestFactory:d,deferredFactory:e,errorOnCancel:!0},get:function(a,b){return b=o.extend(b,{method:"get",url:a}),u(b)},post:function(a,b,c){return c=o.extend(c,{method:"post",url:a,data:b}),u(c)},jsonp:function(a,b){return b=o.extend(b,{method:"jsonp",url:a}),u(b)},"delete":function(a,b){return b=o.extend(b,{method:"delete",url:a}),u(b)},head:function(a,b){return b=o.extend(b,{method:"head",url:a}),u(b)},put:function(a,b,c){return c=o.extend(c,{method:"put",url:a,data:b}),u(c)},patch:function(a,b,c){return c=o.extend(c,{method:"patch",url:a,data:b}),u(c)},getScript:function(a,b){return b=o.extend(b,{method:"script",url:a}),u(b)}}),u.serializer=b,u.parser=c,u.RequestFactory=d,u.DeferredFactory=e,u.QDeferredFactory=f;var v=t.define([function(){this._succeeded=new s,this._errored=new s},{resolve:function(a){this._succeeded.trigger(a),this._cleanUp()},reject:function(a){this._errored.trigger(a),this._cleanUp()},promise:{then:function(a,b){this._succeeded.addOnce(a),this._errored.addOnce(b)},success:function(a){this._succeeded.addOnce(function(b){a(b.data,b.status,b.statusText,b.headers,b.options,b.canceled)})},error:function(a){this._errored.addOnce(function(b){a(b.data,b.status,b.statusText,b.headers,b.options,b.canceled)})},cancel:function(){this.request&&this.request.cancel()}},_cleanUp:function(){this._succeeded.removeAll(),this._succeeded=null,this._errored.removeAll(),this._errored=null}}]),w=0,x=t.define([function(a,b){this._options=a,this._deferred=b,this._id=w++},{send:function(){if(!window.XMLHttpRequest)throw new Error("Recurve only supports IE8+");this._xhr=new XMLHttpRequest,this._config(),this._xhr.onreadystatechange=o.bind(this._stateChangeHandler,this),this._xhr.open(this._options.method.toUpperCase(),this._options.url,!0),this._options.beforeSend&&this._options.beforeSend(this._xhr,this._options),this._xhr.send(this._options.data)},cancel:function(){this._canceled=!0,this._xhr&&this._xhr.abort()},_config:function(){if(this._addHeaders(),this._options.withCredentials&&(this._xhr.withCredentials=!0),this._options.timeout&&(this._xhr.timeout=this._options.timeout),this._options.responseType)try{this._xhr.responseType=this._options.responseType}catch(a){if(!p.isEqualIgnoreCase("json",this._options.method))throw a}},_addHeaders:function(){o.forEach(this._options.headers,function(a,b){a&&this._xhr.setRequestHeader(b,a)})},_stateChangeHandler:function(){4===this._xhr.readyState&&(this._isSuccess()?this._handleSuccess():this._handleError())},_isSuccess:function(){if(this._canceled&&this._options.errorOnCancel)return!1;var a=this._xhr.status;return a>=200&&300>a||304===a||0===a&&r.isFileProtocol()},_handleSuccess:function(){if(this._options.success){var a;if(p.isEqualIgnoreCase("script",this._options.dataType))a=this._request.responseText,r.globalEval(a);else try{a=this._parseResponse()}catch(b){return void this._handleError("unable to parse response")}this._complete(!0,a)}},_handleError:function(a){this._complete(!1,null,a)},_complete:function(a,b,c){var d={data:b,status:this._xhr.status,statusText:c?c:this._xhr.statusText,headers:this._xhr.getAllResponseHeaders(),options:this._options,canceled:this._canceled};a?this._deferred.resolve(d):this._deferred.reject(d)},_parseResponse:function(){var a=this._options.headers&&this._options.headers.Accept;a||(a=this._xhr.getResponseHeader("content-type"));var b;return o.isFunction(this._options.serializer)?(b=this._options.parser(this._xhr),a):o.forEach(this._options.parser,function(c){b=c(this._xhr,a)}),b}}]),y=t.define([function(a,b){this._options=a,this._deferred=b,this._id=w++},{send:function(){function a(a){f=!0,g._canceled&&g._options.errorOnCancel?g._complete():g._complete(!0,a,200)}function b(a){e.removeEventListener("load",b),e.removeEventListener("error",b),document.head.removeChild(e),e=null,delete window[c],a&&"load"===a.type&&!f&&g._complete(!1,null,404,"jsonp callback not called")}var c="RecurveJsonPCallback"+this._id,d=p.removeParameterFromUrl(this._options.url,"callback");d=p.addParametersToUrl(d,{callback:c});var e=document.createElement("script");e.src=d,e.type="text/javascript",e.async=!0;var f,g=this;e.addEventListener("load",b),e.addEventListener("error",b),window[c]=a,document.head.appendChild(e)},cancel:function(){this._canceled=!0},_complete:function(a,b,c,d){var e={data:b,status:c,statusText:d,options:this._options,canceled:this._canceled};a?this._deferred.resolve(e):this._deferred.reject(e)}}]),z=t.define([function(a,b){this._options=a,this._deferred=b,this._id=w++},{send:function(){function a(d){b.removeEventListener("load",a),b.removeEventListener("error",a),document.head.removeChild(b),b=null,d&&"error"===d.type?c._deferred.reject({status:404,canceled:c._canceled}):c._deferred.resolve({status:200,canceled:c._canceled})}var b=document.createElement("script");b.src=this._options.url,b.async=!0;var c=this;b.addEventListener("load",a),b.addEventListener("error",a),document.head.appendChild(b)},cancel:function(){this._canceled=!0}}])},{"./recurve-object.js":9,"./recurve-proto.js":10,"./recurve-signal.js":11,"./recurve-string.js":12,"./recurve-window.js":13}],7:[function(a,b){"use strict";var c=a("./recurve-proto.js");b.exports=c.define([{info:function(){console&&console.log.apply(console,arguments)},debug:function(){return console&&console.debug?void console.debug.apply(console,arguments):void this.info.apply(this,arguments)},warn:function(){return console&&console.warn?void console.warn.apply(console,arguments):void this.info.apply(this,arguments)},error:function(){return console&&console.error?void console.error.apply(console,arguments):void this.info.apply(this,arguments)},clear:function(){console&&console.clear()}}])},{"./recurve-proto.js":10}],8:[function(a,b){"use strict";var c=a("./recurve-proto.js"),d=a("./recurve-array.js"),e=a("./recurve-string.js"),f=a("./recurve-log-console.js");b.exports=c.define([function(a,b){void 0===a&&(a=!0),void 0===b&&(b=[new f]),this.targets=b,this.disable(!a)},{info:function(a){this._infoDisabled||this._log("info",a,arguments)},debug:function(a){this._debugDisabled||this._log("debug",a,arguments)},warn:function(a){this._warnDisabled||this._log("warn",a,arguments)},error:function(a){this._errorDisabled||this._log("error",a,arguments)},clear:function(){for(var a=0;a<this.targets.length;a++)this.targets[a].clear()},disable:function(a){void 0===a&&(a=!0),this._debugDisabled=a,this._infoDisabled=a,this._warnDisabled=a,this._errorDisabled=a},debugDisable:function(a){void 0===a&&(a=!0),this._debugDisabled=a},infoDisable:function(a){void 0===a&&(a=!0),this._infoDisabled=a},warnDisable:function(a){void 0===a&&(a=!0),this._warnDisabled=a},errorDisable:function(a){void 0===a&&(a=!0),this._errorDisabled=a},_log:function(a,b,c){c=d.argumentsToArray(c,1);for(var e=this._description(a.toUpperCase()),f=0;f<this.targets.length;f++)this.targets[f][a].apply(this.targets[f],[e,b].concat(c))},_description:function(a){var b=e.formatTime(new Date);return"["+a+"] "+b}}])},{"./recurve-array.js":2,"./recurve-log-console.js":7,"./recurve-proto.js":10,"./recurve-string.js":12}],9:[function(a,b){"use strict";b.exports={forEach:function(a,b,c){if(a){if(a.forEach&&a.forEach===Object.forEach)a.forEach(b,c);else if(this.isArray(a)&&a.length){for(var d=0;d<a.length;d++)if(!1===b.call(c,a[d],d,a))return}else for(var e=this.keys(a),d=0;d<e.length;d++)if(!1===b.call(c,a[e[d]],e[d],a))return;return e}},keys:function(a){if(!this.isObject(a))return[];if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},isString:function(a){return a instanceof String||"string"==typeof a},isError:function(a){return a instanceof Error},isObject:function(a){return a===Object(a)},isArray:function(a){return a instanceof Array},isFunction:function(a){return"function"==typeof a},isDate:function(a){return a instanceof Date},isFile:function(){return"[object File]"===String(data)},bind:function(a,b){if(!this.isFunction(a))throw new TypeError("not a function");if(Function.prototype.bind)return Function.prototype.bind.apply(a,Array.prototype.slice.call(arguments,1));var c=Array.prototype.slice.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(Array.prototype.slice.call(arguments)));bindCtor.prototype=a.prototype;var e=new bindCtor;bindCtor.prototype=null;var f=a.apply(e,c.concat(Array.prototype.slice.call(arguments)));return Object(f)===f?f:e};return d},extend:function(a,b){if(b){for(key in b)a[key]=b[key];return a}},toJson:function(a){if(!this.isObject(a))throw new Error("not an object to convert to JSON");return JSON.stringify(a)},fromJson:function(a){return a?JSON.parse(a):null},toFormData:function(a){if(!a)return null;var b=[];return this.forEach(a,function(a,c){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}),b.join("&")}}},{}],10:[function(a,b){function c(a){return a&&"function"==typeof a}var d={},e=function(){};e.define=function(a){function b(a){d!=a&&c(this.$ctor)&&this.$ctor.apply(this,arguments)}function e(a,d,e){b.prototype[a]=c(d)&&c(e)?function(){return this._super=e,d.apply(this,arguments)}:d}if(!a||0===a.length)return this;var f,g,h=a[0];c(h)?(f=1<a.length?a[1]:{},f.$ctor=h,g=a[2]):(f=a[0],g=a[1]),b.prototype=new this(d);for(key in f)e(key,f[key],b.prototype[key]);b.prototype.constructor=b,b.extend=this.extend||this.define,b.mixin=this.mixin;for(key in g)b[key]=g[key];return b},e.mixin=function(a){e.mixinWith(this,a)},e.mixinWith=function(a,b){for(key in b)a.prototype[key]=b[key]},b.exports=e},{}],11:[function(a,b){"use strict";var c=a("./recurve-proto.js");b.exports=c.define([function(){this._listeners=[]},{add:function(a,b){a&&(this._listenerExists(a,b)||this._listeners.push(new d(a,b)))},addOnce:function(a,b){a&&(this._listenerExists(a,b)||this._listeners.push(new d(a,b,!0)))},remove:function(a,b){for(var c=0;c<this._listeners.length;c++){var d,e=this._listeners[c];if(a?e.isSame(a,b)&&(d=!0):e.isSameContext(b)&&(d=!0),d&&(Recurve.ArrayUtils.removeAt(this._listeners,c),a))return}},removeAll:function(){this._listeners=[]},trigger:function(){if(!this._disabled)for(var a=this._listeners.length-1;a>=0;a--){var b=this._listeners[a];b.trigger(arguments),b.onlyOnce&&Recurve.ArrayUtils.removeAt(this._listeners,a)}},disable:function(a){void 0===a&&(a=!0),this._disabled=a},_listenerExists:function(a,b){for(var c=this._listeners.length-1;c>=0;c--){var d=this._listeners[c];if(d.isSame(a,b))return!0}return!1}}]);var d=c.define([function(a,b,c){this._callback=a,this._context=b,this.onlyOnce=c},{isSame:function(a,b){return b?this._callback===a&&this._context===b:this._callback===a},isSameContext:function(a){return this._context===a},trigger:function(a){this._callback.apply(this._context,a)}}])},{"./recurve-proto.js":10}],12:[function(a,b){"use strict";var c=a("./recurve-object.js");b.exports={format:function(a){if(!a)return null;Array.prototype.shift.apply(arguments);for(var b=0;b<arguments.length;b++){var c="{"+b+"}";a=a.replace(c,arguments[b])}return a},formatWithProperties:function(a,b){if(!a)return null;for(var c in b)if(b.hasOwnProperty(c)){var d="{"+c+"}";a=a.replace(d,b[c])}return a},pad:function(a,b,c){for(void 0===c&&(c="0"),a=String(a);a.length<b;)a=c+a;return a},formatTime:function(a){void 0===a&&(a=new Date);var b=this.pad(a.getHours(),2),c=this.pad(a.getMinutes(),2),d=this.pad(a.getSeconds(),2),e=this.pad(a.getMilliseconds(),2);return this.format("{0}:{1}:{2}:{3}",b,c,d,e)},formatMonthDayYear:function(a){if(!a)return"";var b=this.pad(a.getMonth()+1),c=this.pad(a.getDate()),d=a.getFullYear();return this.format("{0}/{1}/{2}",b,c,d)},formatYearRange:function(a,b){var c="";return c=a&&b?a+" - "+b:a?a:b},capitalizeFirstCharacter:function(a){return a?a.charAt(0).toUpperCase()+a.slice(1):null},urlLastPath:function(a){if(a){var b=a.split("/");return 0<b.length?b[b.length-1]:null}},hasValue:function(a){return a&&0<a.length},linesOf:function(a){var b;return a&&(b=a.split("\n")),b},isEqual:function(a,b,c){return a&&b?(c&&(a=a.toLowerCase(),b=b.toLowerCase()),a==b):a==b},isEqualIgnoreCase:function(a,b){return this.isEqual(a,b,!0)},contains:function(a,b,c){return a&&b?(c&&(a=a.toLowerCase(),b=b.toLowerCase()),0<=a.indexOf(b)):a==b},addParametersToUrl:function(a,b){if(a&&b){var d=this.contains(a,"?")?"&":"?";for(var e in b){var f=b[e];c.isObject(f)&&(f=c.isDate(f)?f.toISOString():c.toJson(f)),a+=d+encodeURIComponent(e)+encodeURIComponent(b[e]),d="?"}return a}},removeParameterFromUrl:function(a,b){if(a&&b){var c=b+"=",d=a.indexOf(c);if(-1!==index){var e=a.indexOf("&",d);return a=e>-1?a.substr(0,Math.max(d-1,0))+a.substr(e):a.substr(0,Math.max(d-1,0))}}}}},{"./recurve-object.js":9}],13:[function(a,b){"use strict";b.exports={isFileProtocol:function(){return"file:"===window.location.protocol},globalEval:function(a){if(a){window.execScript&&window.execScript(a);var b=function(){window.eval.call(window.src)};b()}}}},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13]);